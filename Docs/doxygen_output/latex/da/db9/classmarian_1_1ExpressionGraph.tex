\hypertarget{classmarian_1_1ExpressionGraph}{}\section{marian\+:\+:Expression\+Graph Class Reference}
\label{classmarian_1_1ExpressionGraph}\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}


Represents a computation graph of expressions, over which algorithmic differentiation may be performed.  




{\ttfamily \#include $<$expression\+\_\+graph.\+h$>$}



Inheritance diagram for marian\+:\+:Expression\+Graph\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{dc/dae/classmarian_1_1ExpressionGraph__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for marian\+:\+:Expression\+Graph\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/db8/classmarian_1_1ExpressionGraph__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmarian_1_1ExpressionGraph_a40b3f2a4c0bacb782241f321bd1d429c}{Expression\+Graph} (bool inference=false)
\begin{DoxyCompactList}\small\item\em Constructs a new expression graph. \end{DoxyCompactList}\item 
\hyperlink{classmarian_1_1ExpressionGraph_a9dbcf2ff5e7ad496082daab4c71e4ea4}{$\sim$\+Expression\+Graph} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a887b328e3073bbdef1869ae6ff632ca4}{set\+Device} (size\+\_\+t device=0)
\item 
size\+\_\+t \hyperlink{classmarian_1_1ExpressionGraph_a6de2782630380b0b2d3a1ded6db5324d}{get\+Device} ()
\item 
\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1Backend}{Backend} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a714920827388a0d6f880a90c2e5e5be0}{get\+Backend} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_aec6911dc81df2dfbfb2c3ee6cfa6532a}{switch\+Params} (const std\+::string \&new\+Namespace)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_ae746a90c60109c20fd154ec6f491ea0e}{reserve\+Workspace\+MB} (size\+\_\+t num)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a9b2b3ec0ad988aad229f779416632aa8}{copy\+Params} (\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1ExpressionGraph}{Expression\+Graph} $>$ graph)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a9ffa36f849946ba0153bd0e8f18e31f9}{reuse\+Workspace} (\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1ExpressionGraph}{Expression\+Graph} $>$ graph)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465}{backprop} ()
\begin{DoxyCompactList}\small\item\em Performs backpropogation on this expression graph. \end{DoxyCompactList}\item 
bool \hyperlink{classmarian_1_1ExpressionGraph_a1ce5fad852cb6d30cfd0a2d729bb44c3}{fits} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370}{forward} ()
\begin{DoxyCompactList}\small\item\em Perform the forward pass of algorithmic differentiation (AD) on this graph. \end{DoxyCompactList}\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a41337743d6e030cf6b8e2b2e4d39a908}{forward\+Next} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3}{backward} ()
\begin{DoxyCompactList}\small\item\em Perform the backward pass of algorithmic differentiation (AD) on this graph. \end{DoxyCompactList}\item 
std\+::string \hyperlink{classmarian_1_1ExpressionGraph_a3bbdbd8964031c78c7825958d1e9c9fe}{graphviz} ()
\begin{DoxyCompactList}\small\item\em Returns a string representing this expression graph in {\ttfamily graphviz} notation. \end{DoxyCompactList}\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a88799e5f11eafccfcd165c4ecee9d04f}{graphviz} (const std\+::string \&filename)
\item 
{\footnotesize template$<$typename... Args$>$ }\\\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d}{param} (std\+::string name, \hyperlink{structmarian_1_1Shape}{Shape} shape, Args...\+args)
\begin{DoxyCompactList}\small\item\em Constructs a new node representing a parameter in an expression graph. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename... Args$>$ }\\\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a98fec0be161df64c066f9d871aba4274}{constant} (\hyperlink{structmarian_1_1Shape}{Shape} shape, Args...\+args)
\begin{DoxyCompactList}\small\item\em Constructs a new node representing a constant in an expression graph. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename... Args$>$ }\\\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a836f54cf0875925d01380999d6f53483}{ones} (Args...\+args)
\begin{DoxyCompactList}\small\item\em Constructs a new node representing a constant (with value 1) in an expression graph. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename... Args$>$ }\\\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a5287d5dbc9db07b0d00e5cbf58d168c3}{zeros} (Args...\+args)
\begin{DoxyCompactList}\small\item\em Constructs a new node representing a constant (with value 0) in an expression graph. \end{DoxyCompactList}\item 
\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a187a176cd6a6b793b6b65dc1a13814e5}{dropout} (float prob, \hyperlink{structmarian_1_1Shape}{Shape} shape)
\item 
\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a0816bd611240498f346c3557593b2538}{gaussian} (float \hyperlink{namespacemarian_a15ec9743709e47180378db974ddbf116}{mean}, float stddev, \hyperlink{structmarian_1_1Shape}{Shape} shape)
\item 
\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a89df066a4abd34e1e999303cc53edd1e}{get} (std\+::string name)
\begin{DoxyCompactList}\small\item\em Returns the first item in the list with the specified name, if such an item exists. \end{DoxyCompactList}\item 
\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1Parameters}{Parameters} $>$ \& \hyperlink{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}{params} ()
\begin{DoxyCompactList}\small\item\em Gets the list of all parameter nodes of this expression graph. \end{DoxyCompactList}\item 
\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} \hyperlink{classmarian_1_1ExpressionGraph_a95bb5e6efbc99952867e46f5db9dc461}{add} (\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} node)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a6ac51867f0abfd22696e85b392f1bfcb}{remove\+\_\+top\+\_\+node} (\hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} node)
\item 
{\footnotesize template$<$class... Args$>$ }\\void \hyperlink{classmarian_1_1ExpressionGraph_a7bd933313f66b7a696292fc17b21d78b}{tensor} (\hyperlink{namespacemarian_a88b71ec34bb354564cddc24eb80f7e14}{Tensor} \&t, Args \&\&...args)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a12e72d92651d3eb42762a0fdccf3c560}{free} (\hyperlink{namespacemarian_a88b71ec34bb354564cddc24eb80f7e14}{Tensor} \&t)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a97c49d6448e774f350083559f02719ad}{clear} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a3525ef405ce9f66ec86a47e9178dad72}{clear\+Parameters} ()
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_ae3a2ead5df1981b78a78f72c363b5a47}{set\+Reloaded} (bool reloaded)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a67747b40ca80d7dc5b5dbd3d45793cce}{load} (const std\+::string \&name)
\item 
void \hyperlink{classmarian_1_1ExpressionGraph_a760757f21a572d7e80baf2c1cb0d3521}{save} (const std\+::string \&name)
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmarian_1_1ExpressionGraph_a65e074b28afd37450ef025bb97e06efa}{Expression\+Graph} (const \hyperlink{classmarian_1_1ExpressionGraph}{Expression\+Graph} \&)=delete
\item 
\hyperlink{classmarian_1_1ExpressionGraph_ac1669810aad34acc14f6f2e5eea13a9d}{Expression\+Graph} (\hyperlink{classmarian_1_1ExpressionGraph}{Expression\+Graph} \&\&)=delete
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
size\+\_\+t \hyperlink{classmarian_1_1ExpressionGraph_af46afb7a2ba6ef751c927ccf98276b57}{count\+\_\+} \{0\}
\item 
std\+::list$<$ \hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodes\+Forward\+\_\+}
\item 
std\+::list$<$ \hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodes\+Backward\+\_\+}
\item 
std\+::unordered\+\_\+set$<$ \hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{top\+Nodes\+\_\+}
\item 
\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1Parameters}{Parameters} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\+\_\+}
\item 
\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1TensorAllocator}{Tensor\+Allocator} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\+\_\+}
\item 
size\+\_\+t \hyperlink{classmarian_1_1ExpressionGraph_a25101cf64e67c3479ff3fff20a84b3a3}{device\+\_\+}
\item 
\hyperlink{namespacemarian_ad1a373be43a00ef9ce35666145137b08}{Ptr}$<$ \hyperlink{classmarian_1_1Backend}{Backend} $>$ \hyperlink{classmarian_1_1ExpressionGraph_a0f7e6ae1853ea83f5adc80fe3f5b2cb7}{backend\+\_\+}
\item 
std\+::unordered\+\_\+map$<$ size\+\_\+t, \hyperlink{namespacemarian_a2b926a792e343705a2eb5224771f47de}{W\+Expr} $>$ \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hash\+Map\+\_\+}
\item 
bool \hyperlink{classmarian_1_1ExpressionGraph_aa2c948ce5f377474df5f3a30db424541}{inference\+Only\+\_\+} \{false\}
\item 
bool \hyperlink{classmarian_1_1ExpressionGraph_aa10988c85ca38b3a1ffd72fa42278987}{reloaded\+\_\+} \{false\}
\item 
std\+::string \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Represents a computation graph of expressions, over which algorithmic differentiation may be performed. 

Definition at line 28 of file expression\+\_\+graph.\+h.



\subsection{Constructor \& Destructor Documentation}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!Expression\+Graph@{Expression\+Graph}}
\index{Expression\+Graph@{Expression\+Graph}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{Expression\+Graph(const Expression\+Graph \&)=delete}{ExpressionGraph(const ExpressionGraph &)=delete}}]{\setlength{\rightskip}{0pt plus 5cm}marian\+::\+Expression\+Graph\+::\+Expression\+Graph (
\begin{DoxyParamCaption}
\item[{const {\bf Expression\+Graph} \&}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [delete]}}\hypertarget{classmarian_1_1ExpressionGraph_a65e074b28afd37450ef025bb97e06efa}{}\label{classmarian_1_1ExpressionGraph_a65e074b28afd37450ef025bb97e06efa}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!Expression\+Graph@{Expression\+Graph}}
\index{Expression\+Graph@{Expression\+Graph}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{Expression\+Graph(\+Expression\+Graph \&\&)=delete}{ExpressionGraph(ExpressionGraph &&)=delete}}]{\setlength{\rightskip}{0pt plus 5cm}marian\+::\+Expression\+Graph\+::\+Expression\+Graph (
\begin{DoxyParamCaption}
\item[{{\bf Expression\+Graph} \&\&}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [delete]}}\hypertarget{classmarian_1_1ExpressionGraph_ac1669810aad34acc14f6f2e5eea13a9d}{}\label{classmarian_1_1ExpressionGraph_ac1669810aad34acc14f6f2e5eea13a9d}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!Expression\+Graph@{Expression\+Graph}}
\index{Expression\+Graph@{Expression\+Graph}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{Expression\+Graph(bool inference=false)}{ExpressionGraph(bool inference=false)}}]{\setlength{\rightskip}{0pt plus 5cm}marian\+::\+Expression\+Graph\+::\+Expression\+Graph (
\begin{DoxyParamCaption}
\item[{bool}]{inference = {\ttfamily false}}
\end{DoxyParamCaption}
)}\hypertarget{classmarian_1_1ExpressionGraph_a40b3f2a4c0bacb782241f321bd1d429c}{}\label{classmarian_1_1ExpressionGraph_a40b3f2a4c0bacb782241f321bd1d429c}


Constructs a new expression graph. 

Constructor should be used as \hyperlink{namespacemarian_afe55543784336e96f224f9d88206d1fb}{New$<$\+Expression\+Graph$>$()} \index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!````~Expression\+Graph@{$\sim$\+Expression\+Graph}}
\index{````~Expression\+Graph@{$\sim$\+Expression\+Graph}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{$\sim$\+Expression\+Graph()}{~ExpressionGraph()}}]{\setlength{\rightskip}{0pt plus 5cm}marian\+::\+Expression\+Graph\+::$\sim$\+Expression\+Graph (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a9dbcf2ff5e7ad496082daab4c71e4ea4}{}\label{classmarian_1_1ExpressionGraph_a9dbcf2ff5e7ad496082daab4c71e4ea4}


Definition at line 60 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
60                      \{
61     \hyperlink{classmarian_1_1ExpressionGraph_a97c49d6448e774f350083559f02719ad}{clear}();
62     \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->clear();
63   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a9dbcf2ff5e7ad496082daab4c71e4ea4_cgraph}
\end{center}
\end{figure}




\subsection{Member Function Documentation}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!add@{add}}
\index{add@{add}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{add(\+Expr node)}{add(Expr node)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Expr} marian\+::\+Expression\+Graph\+::add (
\begin{DoxyParamCaption}
\item[{{\bf Expr}}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a95bb5e6efbc99952867e46f5db9dc461}{}\label{classmarian_1_1ExpressionGraph_a95bb5e6efbc99952867e46f5db9dc461}


Definition at line 374 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
374                       \{
375     \textcolor{comment}{// size\_t group = 0;}
376 
377     \textcolor{keywordtype}{size\_t} hash = node->hash();
378     \textcolor{keyword}{auto} it = \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}.find(hash);
379     \textcolor{keywordflow}{if}(it != \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}.end()) \{
380       \textcolor{keywordflow}{return} it->second.lock();
381     \}
382 
383     \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}[hash] = node;
384 
385     node->setId(\hyperlink{classmarian_1_1ExpressionGraph_af46afb7a2ba6ef751c927ccf98276b57}{count\_}++);
386 
387     \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.push\_back(node);
388     \textcolor{keywordflow}{if}(!\hyperlink{classmarian_1_1ExpressionGraph_aa2c948ce5f377474df5f3a30db424541}{inferenceOnly\_} && node->trainable()) \{
389       \hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodesBackward\_}.push\_back(node);
390       \hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{topNodes\_}.insert(node);
391     \}
392 
393     \textcolor{keywordflow}{return} node;
394   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a95bb5e6efbc99952867e46f5db9dc461_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!backprop@{backprop}}
\index{backprop@{backprop}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{backprop()}{backprop()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::backprop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465}{}\label{classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465}


Performs backpropogation on this expression graph. 

Backpropogation is implemented by performing first the forward pass and then the backward pass of algorithmic differentiation (AD) on the nodes of the graph. 

Definition at line 97 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
97                   \{
98     \hyperlink{classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370}{forward}();
99     \hyperlink{classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3}{backward}();
100   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!backward@{backward}}
\index{backward@{backward}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{backward()}{backward()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::backward (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3}{}\label{classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3}


Perform the backward pass of algorithmic differentiation (AD) on this graph. 

This pass traverses the nodes of this graph in reverse of the order they were created; as each node is traversed, its {\ttfamily set\+\_\+zero\+\_\+adjoint()} method is called.

Once this has been performed for all nodes, this pass again traverses the nodes, again in reverse creation order; as each node is traversed, its {\ttfamily \hyperlink{classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3}{backward()}} method is called.

After this method has successfully completed, and that all backward pass computations have been performed. 

Definition at line 172 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
172                   \{
173     UTIL\_THROW\_IF2(\hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{topNodes\_}.size() > 1,
174                    \textcolor{stringliteral}{"There are more than one top most node for backward step"});
175 
176     \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->allocateBackward();
177     \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->set\_zero\_adjoint();
178 
179     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}&& v : \hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{topNodes\_})
180       v->init\_dependent();
181 
182     \textcolor{comment}{// named\_.clear();}
183     topNodes\_.clear();
184     \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}.clear();
185 
186     \textcolor{keywordflow}{while}(!\hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodesBackward\_}.empty()) \{
187       \textcolor{keyword}{auto} v = \hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodesBackward\_}.back();
188       \hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodesBackward\_}.pop\_back();
189 
190       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}&& child : v->children()) \{
191         \textcolor{keywordflow}{if}(child->trainable())
192           child->set\_zero\_adjoint();
193       \}
194       \textcolor{keywordflow}{if}(v->trainable())
195         v->backward();
196 
197       \textcolor{keywordflow}{if}(v->trainable() && v->marked\_for\_debug()) \{
198         std::cerr << \textcolor{stringliteral}{"Debug Grad: "} << v->debug\_message() << std::endl;
199         std::cerr << v->grad()->debug() << std::endl;
200       \}
201 
202       v->children().clear();
203     \}
204   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_ae4be44e38a47b0964a24880078eb16c3_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!clear@{clear}}
\index{clear@{clear}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{clear()}{clear()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::clear (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a97c49d6448e774f350083559f02719ad}{}\label{classmarian_1_1ExpressionGraph_a97c49d6448e774f350083559f02719ad}


Definition at line 408 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
408                \{
409     \textcolor{comment}{// clear everything apart from parameters}
410     \hyperlink{classmarian_1_1ExpressionGraph_af46afb7a2ba6ef751c927ccf98276b57}{count\_} = 0;
411     \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.clear();
412     \hyperlink{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{nodesBackward\_}.clear();
413 
414     \hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{topNodes\_}.clear();
415     \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}.clear();
416     \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->clear();
417   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a97c49d6448e774f350083559f02719ad_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!clear\+Parameters@{clear\+Parameters}}
\index{clear\+Parameters@{clear\+Parameters}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{clear\+Parameters()}{clearParameters()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::clear\+Parameters (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a3525ef405ce9f66ec86a47e9178dad72}{}\label{classmarian_1_1ExpressionGraph_a3525ef405ce9f66ec86a47e9178dad72}


Definition at line 419 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
419 \{ \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->clear(); \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!constant@{constant}}
\index{constant@{constant}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{constant(\+Shape shape, Args...\+args)}{constant(Shape shape, Args...args)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename... Args$>$ {\bf Expr} marian\+::\+Expression\+Graph\+::constant (
\begin{DoxyParamCaption}
\item[{{\bf Shape}}]{shape, }
\item[{Args...}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a98fec0be161df64c066f9d871aba4274}{}\label{classmarian_1_1ExpressionGraph_a98fec0be161df64c066f9d871aba4274}


Constructs a new node representing a constant in an expression graph. 

This method does not attach the new constant node to any existing expression graph.

\begin{DoxyReturn}{Returns}
a newly constructed constant node 
\end{DoxyReturn}


Definition at line 300 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
300                                            \{
301     \textcolor{keywordflow}{return} Expression<ConstantNode>(
302         shared\_from\_this(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{keywords::shape} = \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, args...);
303   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!copy\+Params@{copy\+Params}}
\index{copy\+Params@{copy\+Params}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{copy\+Params(\+Ptr$<$ Expression\+Graph $>$ graph)}{copyParams(Ptr< ExpressionGraph > graph)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::copy\+Params (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Expression\+Graph} $>$}]{graph}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a9b2b3ec0ad988aad229f779416632aa8}{}\label{classmarian_1_1ExpressionGraph_a9b2b3ec0ad988aad229f779416632aa8}


Definition at line 79 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
79                                               \{
80     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} p : *graph->params())
81       \hyperlink{classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d}{param}(p->name(), p->shape());
82     \hyperlink{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}{params}()->allocateForward();
83     \hyperlink{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}{params}()->vals()->copyFrom(graph->params()->vals());
84   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a9b2b3ec0ad988aad229f779416632aa8_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!dropout@{dropout}}
\index{dropout@{dropout}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{dropout(float prob, Shape shape)}{dropout(float prob, Shape shape)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Expr} marian\+::\+Expression\+Graph\+::dropout (
\begin{DoxyParamCaption}
\item[{float}]{prob, }
\item[{{\bf Shape}}]{shape}
\end{DoxyParamCaption}
)}\hypertarget{classmarian_1_1ExpressionGraph_a187a176cd6a6b793b6b65dc1a13814e5}{}\label{classmarian_1_1ExpressionGraph_a187a176cd6a6b793b6b65dc1a13814e5}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a187a176cd6a6b793b6b65dc1a13814e5_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!fits@{fits}}
\index{fits@{fits}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{fits()}{fits()}}]{\setlength{\rightskip}{0pt plus 5cm}bool marian\+::\+Expression\+Graph\+::fits (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a1ce5fad852cb6d30cfd0a2d729bb44c3}{}\label{classmarian_1_1ExpressionGraph_a1ce5fad852cb6d30cfd0a2d729bb44c3}


Definition at line 102 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
102               \{
103     \textcolor{keywordflow}{try} \{
104       \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->throwAtReallocation(\textcolor{keyword}{true});
105       \hyperlink{classmarian_1_1ExpressionGraph_aac6f1862944bd673e6874662d9d4b465}{backprop}();
106       \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->throwAtReallocation(\textcolor{keyword}{false});
107     \} \textcolor{keywordflow}{catch}(AllocationException& e) \{
108       \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->throwAtReallocation(\textcolor{keyword}{false});
109       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
110     \}
111     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
112   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a1ce5fad852cb6d30cfd0a2d729bb44c3_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!forward@{forward}}
\index{forward@{forward}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{forward()}{forward()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::forward (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370}{}\label{classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370}


Perform the forward pass of algorithmic differentiation (AD) on this graph. 

This pass traverses the nodes of this graph in the order they were created; as each node is traversed, its {\ttfamily allocate()} method is called.

Once allocation is complete for all nodes, this pass again traverses the nodes, in creation order; as each node is traversed, its {\ttfamily \hyperlink{classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370}{forward()}} method is called.

After this method has successfully completed, it is guaranteed that all node allocation has been completed, and that all forward pass computations have been performed. 

Definition at line 130 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
130                  \{
131     \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->allocateForward();
132     \hyperlink{classmarian_1_1ExpressionGraph_a41337743d6e030cf6b8e2b2e4d39a908}{forwardNext}();
133   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_aa7596e34cc2895cf374ce06d9d5ee370_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!forward\+Next@{forward\+Next}}
\index{forward\+Next@{forward\+Next}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{forward\+Next()}{forwardNext()}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::forward\+Next (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a41337743d6e030cf6b8e2b2e4d39a908}{}\label{classmarian_1_1ExpressionGraph_a41337743d6e030cf6b8e2b2e4d39a908}


Definition at line 135 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
135                      \{
136     \textcolor{comment}{// @TODO: check if allocation works properly}
137     \hyperlink{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{hashMap\_}.clear();
138 
139     \textcolor{keywordflow}{while}(!\hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.empty()) \{
140       \textcolor{keyword}{auto} v = \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.front();
141       v->allocate();
142       v->init();
143       v->forward();
144 
145       \textcolor{keywordflow}{if}(v->marked\_for\_debug()) \{
146         std::cerr << \textcolor{stringliteral}{"Debug: "} << v->debug\_message() << std::endl;
147         std::cerr << v->val()->debug() << std::endl;
148       \}
149 
150       \textcolor{keywordflow}{if}(\hyperlink{classmarian_1_1ExpressionGraph_aa2c948ce5f377474df5f3a30db424541}{inferenceOnly\_})
151         v->children().clear();
152       \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.pop\_front();
153     \}
154   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a41337743d6e030cf6b8e2b2e4d39a908_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!free@{free}}
\index{free@{free}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{free(\+Tensor \&t)}{free(Tensor &t)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::free (
\begin{DoxyParamCaption}
\item[{{\bf Tensor} \&}]{t}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a12e72d92651d3eb42762a0fdccf3c560}{}\label{classmarian_1_1ExpressionGraph_a12e72d92651d3eb42762a0fdccf3c560}


Definition at line 403 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
403                        \{
404     \textcolor{keywordflow}{if}(\hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_})
405       \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->free(t);
406   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!gaussian@{gaussian}}
\index{gaussian@{gaussian}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{gaussian(float mean, float stddev, Shape shape)}{gaussian(float mean, float stddev, Shape shape)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Expr} marian\+::\+Expression\+Graph\+::gaussian (
\begin{DoxyParamCaption}
\item[{float}]{mean, }
\item[{float}]{stddev, }
\item[{{\bf Shape}}]{shape}
\end{DoxyParamCaption}
)}\hypertarget{classmarian_1_1ExpressionGraph_a0816bd611240498f346c3557593b2538}{}\label{classmarian_1_1ExpressionGraph_a0816bd611240498f346c3557593b2538}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a0816bd611240498f346c3557593b2538_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!get@{get}}
\index{get@{get}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{get(std\+::string name)}{get(std::string name)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Expr} marian\+::\+Expression\+Graph\+::get (
\begin{DoxyParamCaption}
\item[{std\+::string}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a89df066a4abd34e1e999303cc53edd1e}{}\label{classmarian_1_1ExpressionGraph_a89df066a4abd34e1e999303cc53edd1e}


Returns the first item in the list with the specified name, if such an item exists. 

If no item with the specified name is found in the graph, this method throws an exception.


\begin{DoxyParams}{Parameters}
{\em name} & Name of the desired expression node\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the first item in the list with the specified name, if such an item exists 
\end{DoxyReturn}


Definition at line 357 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
357                            \{
358     \textcolor{keywordflow}{if}(!\hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_}.empty())
359       name = \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_} + \textcolor{stringliteral}{"::"} + name;
360 
361     \textcolor{keyword}{auto} e = \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->get(name);
362     \textcolor{keywordflow}{if}(e)
363       \textcolor{keywordflow}{return} e;
364     \textcolor{keywordflow}{return} \hyperlink{namespacemarian_a498d8baf75b754011078b890b39c8e12}{Expr}();
365   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!get\+Backend@{get\+Backend}}
\index{get\+Backend@{get\+Backend}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{get\+Backend()}{getBackend()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Backend}$>$ marian\+::\+Expression\+Graph\+::get\+Backend (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a714920827388a0d6f880a90c2e5e5be0}{}\label{classmarian_1_1ExpressionGraph_a714920827388a0d6f880a90c2e5e5be0}


Definition at line 68 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
68 \{ \textcolor{keywordflow}{return} \hyperlink{classmarian_1_1ExpressionGraph_a0f7e6ae1853ea83f5adc80fe3f5b2cb7}{backend\_}; \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!get\+Device@{get\+Device}}
\index{get\+Device@{get\+Device}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{get\+Device()}{getDevice()}}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t marian\+::\+Expression\+Graph\+::get\+Device (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a6de2782630380b0b2d3a1ded6db5324d}{}\label{classmarian_1_1ExpressionGraph_a6de2782630380b0b2d3a1ded6db5324d}


Definition at line 66 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
66 \{ \textcolor{keywordflow}{return} \hyperlink{classmarian_1_1ExpressionGraph_a25101cf64e67c3479ff3fff20a84b3a3}{device\_}; \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a6de2782630380b0b2d3a1ded6db5324d_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!graphviz@{graphviz}}
\index{graphviz@{graphviz}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{graphviz()}{graphviz()}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string marian\+::\+Expression\+Graph\+::graphviz (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a3bbdbd8964031c78c7825958d1e9c9fe}{}\label{classmarian_1_1ExpressionGraph_a3bbdbd8964031c78c7825958d1e9c9fe}


Returns a string representing this expression graph in {\ttfamily graphviz} notation. 

This string can be used by {\ttfamily graphviz} tools to visualize the expression graph.

\begin{DoxyReturn}{Returns}
a string representing this expression graph in {\ttfamily graphviz} notation 
\end{DoxyReturn}


Definition at line 216 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
216                        \{
217     std::stringstream ss;
218     ss << \textcolor{stringliteral}{"digraph ExpressionGraph \{"} << std::endl;
219     \textcolor{comment}{// ss << "graph[splines=ortho]" << std::endl;}
220     ss << \textcolor{stringliteral}{"rankdir=LR"} << std::endl;
221 
222     \textcolor{keyword}{auto} it = \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.rbegin();
223     \textcolor{keywordflow}{while}(it != \hyperlink{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{nodesForward\_}.rend()) \{
224       \textcolor{keyword}{auto} v = *it;
225       ss << v->graphviz();
226       it++;
227     \}
228 
229     ss << \textcolor{stringliteral}{"\}"} << std::endl;
230     \textcolor{keywordflow}{return} ss.str();
231   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a3bbdbd8964031c78c7825958d1e9c9fe_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!graphviz@{graphviz}}
\index{graphviz@{graphviz}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{graphviz(const std\+::string \&filename)}{graphviz(const std::string &filename)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::graphviz (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{filename}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a88799e5f11eafccfcd165c4ecee9d04f}{}\label{classmarian_1_1ExpressionGraph_a88799e5f11eafccfcd165c4ecee9d04f}


Definition at line 233 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
233                                            \{
234     std::ofstream \hyperlink{namespacemarian_ad7fbf1ba8e2e04ffdc7d5e4841b5e691}{dot}(filename);
235     \hyperlink{namespacemarian_ad7fbf1ba8e2e04ffdc7d5e4841b5e691}{dot} << \hyperlink{classmarian_1_1ExpressionGraph_a3bbdbd8964031c78c7825958d1e9c9fe}{graphviz}();
236     \hyperlink{namespacemarian_ad7fbf1ba8e2e04ffdc7d5e4841b5e691}{dot}.close();
237   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a88799e5f11eafccfcd165c4ecee9d04f_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!load@{load}}
\index{load@{load}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{load(const std\+::string \&name)}{load(const std::string &name)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::load (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a67747b40ca80d7dc5b5dbd3d45793cce}{}\label{classmarian_1_1ExpressionGraph_a67747b40ca80d7dc5b5dbd3d45793cce}


Definition at line 425 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
425                                    \{
426     \textcolor{keyword}{using namespace }\hyperlink{namespacekeywords}{keywords};
427 
428     \hyperlink{amun_2common_2logging_8h_a8cad147aca8c526d3c8a03ae14d5c87d}{LOG}(\hyperlink{namespacefix__hard_a31eedbb056537bc1bef47ad5e40eaa68}{info})->info(\textcolor{stringliteral}{"Loading model from \{\}"}, name);
429 
430     \textcolor{keyword}{auto} numpy = cnpy::npz\_load(name);
431 
432     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it : numpy) \{
433       \textcolor{keyword}{auto} name = it.first;
434       \textcolor{comment}{// skip over special parameters starting with \_}
435       \textcolor{keywordflow}{if}(name.substr(0, 8) == \textcolor{stringliteral}{"special:"})
436         \textcolor{keywordflow}{continue};
437 
438       Shape \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape};
439       \textcolor{keywordflow}{if}(it.second.shape.size() == 1) \{
440         shape.set(0, 1);
441         shape.set(1, it.second.shape[0]);
442       \}
443       \textcolor{keywordflow}{else} \{
444         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < it.second.shape.size(); ++i)
445           shape.set(i, it.second.shape[i]);
446       \}
447 
448       \hyperlink{classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d}{param}(name, shape, \hyperlink{amunmt_8cpp_a2e8ddb8bd2f3405f554c9f2c52277f4b}{init} = \hyperlink{namespacemarian_1_1inits_a466e51fe497018f864f0fb9c0dd05200}{inits::from\_numpy}(it.second));
449     \}
450 
451     \hyperlink{classmarian_1_1ExpressionGraph_ae3a2ead5df1981b78a78f72c363b5a47}{setReloaded}(\textcolor{keyword}{true});
452   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a67747b40ca80d7dc5b5dbd3d45793cce_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!ones@{ones}}
\index{ones@{ones}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{ones(\+Args...\+args)}{ones(Args...args)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename... Args$>$ {\bf Expr} marian\+::\+Expression\+Graph\+::ones (
\begin{DoxyParamCaption}
\item[{Args...}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a836f54cf0875925d01380999d6f53483}{}\label{classmarian_1_1ExpressionGraph_a836f54cf0875925d01380999d6f53483}


Constructs a new node representing a constant (with value 1) in an expression graph. 

This method does not attach the new constant node to any existing expression graph.


\begin{DoxyParams}{Parameters}
{\em args} & X\+XX Marcin, what are args here?\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a newly constructed constant node 
\end{DoxyReturn}


Definition at line 317 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
317                           \{
318     \textcolor{keywordflow}{return} Expression<ConstantNode>(
319         shared\_from\_this(), \hyperlink{namespacemarian_1_1keywords_afdd3807e3d6fe2bc979d11fa0cf3ee3e}{keywords::init} = \hyperlink{namespacemarian_1_1inits_ae2baa2cb7116abb19c235fbe5ed0de9c}{inits::ones}, args...);
320   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{da/db9/classmarian_1_1ExpressionGraph_a836f54cf0875925d01380999d6f53483_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!param@{param}}
\index{param@{param}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{param(std\+::string name, Shape shape, Args...\+args)}{param(std::string name, Shape shape, Args...args)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename... Args$>$ {\bf Expr} marian\+::\+Expression\+Graph\+::param (
\begin{DoxyParamCaption}
\item[{std\+::string}]{name, }
\item[{{\bf Shape}}]{shape, }
\item[{Args...}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d}{}\label{classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d}


Constructs a new node representing a parameter in an expression graph. 

This method records the parameter node in a list of parameter nodes, but does not attach the new parameter node to any existing expression graph.


\begin{DoxyParams}{Parameters}
{\em args} & X\+XX Marcin, what are args here?\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a newly constructed parameter node 
\end{DoxyReturn}


Definition at line 253 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
253                                                         \{
254     \textcolor{keywordflow}{if}(!\hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_}.empty())
255       name = \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_} + \textcolor{stringliteral}{"::"} + name;
256 
257     \textcolor{comment}{// check first if parameter already exists}
258     \textcolor{keyword}{auto} p = \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->get(name);
259     \textcolor{keywordflow}{if}(p) \{
260       \textcolor{comment}{// if yes add to tape and return}
261 
262       UTIL\_THROW\_IF2(\hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape} != p->shape(),
263                      \textcolor{stringliteral}{"Requested shape for existing parameter "}
264                      << name
265                      << \textcolor{stringliteral}{" does not match original shape"});
266 
267       \hyperlink{classmarian_1_1ExpressionGraph_a95bb5e6efbc99952867e46f5db9dc461}{add}(p);
268       \textcolor{keywordflow}{return} p;
269     \}
270 
271     \textcolor{comment}{// if graph was reloaded do not allow creation of new parameters}
272     UTIL\_THROW\_IF2(\hyperlink{classmarian_1_1ExpressionGraph_aa10988c85ca38b3a1ffd72fa42278987}{reloaded\_},
273                    \textcolor{stringliteral}{"Graph was reloaded and parameter "} << name << \textcolor{stringliteral}{" is newly created"});
274 
275     \textcolor{comment}{// if not check if name is not taken by other node}
276     UTIL\_THROW\_IF2(\textcolor{keyword}{get}(name),
277                    \textcolor{stringliteral}{"Non-parameter with name "} << name << \textcolor{stringliteral}{"already exists"});
278 
279 
280     \textcolor{comment}{// create parameter node (adds to tape)}
281     p = Expression<ParamNode>(
282         shared\_from\_this(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{keywords::shape} = \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, args...);
283 
284     \textcolor{comment}{// add to list of parameters}
285     p->set\_name(name);
286     \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}->add(p, name);
287     \textcolor{keywordflow}{return} p;
288   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_afbda84b9c30ce21ba27f2283b6e9db2d_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!params@{params}}
\index{params@{params}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{params()}{params()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Parameters}$>$\& marian\+::\+Expression\+Graph\+::params (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}{}\label{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}


Gets the list of all parameter nodes of this expression graph. 

\begin{DoxyReturn}{Returns}
the list of all parameter nodes of this expression graph 
\end{DoxyReturn}


Definition at line 372 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
372 \{ \textcolor{keywordflow}{return} \hyperlink{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{params\_}; \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!remove\+\_\+top\+\_\+node@{remove\+\_\+top\+\_\+node}}
\index{remove\+\_\+top\+\_\+node@{remove\+\_\+top\+\_\+node}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{remove\+\_\+top\+\_\+node(\+Expr node)}{remove_top_node(Expr node)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::remove\+\_\+top\+\_\+node (
\begin{DoxyParamCaption}
\item[{{\bf Expr}}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a6ac51867f0abfd22696e85b392f1bfcb}{}\label{classmarian_1_1ExpressionGraph_a6ac51867f0abfd22696e85b392f1bfcb}


Definition at line 396 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
396 \{ \hyperlink{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{topNodes\_}.erase(node); \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!reserve\+Workspace\+MB@{reserve\+Workspace\+MB}}
\index{reserve\+Workspace\+MB@{reserve\+Workspace\+MB}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{reserve\+Workspace\+M\+B(size\+\_\+t num)}{reserveWorkspaceMB(size_t num)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::reserve\+Workspace\+MB (
\begin{DoxyParamCaption}
\item[{size\+\_\+t}]{num}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_ae746a90c60109c20fd154ec6f491ea0e}{}\label{classmarian_1_1ExpressionGraph_ae746a90c60109c20fd154ec6f491ea0e}


Definition at line 74 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
74                                       \{
75     \textcolor{keywordtype}{size\_t} bytes = num * 1024 * 1024 - 1;
76     \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->reserve(bytes);
77   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!reuse\+Workspace@{reuse\+Workspace}}
\index{reuse\+Workspace@{reuse\+Workspace}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{reuse\+Workspace(\+Ptr$<$ Expression\+Graph $>$ graph)}{reuseWorkspace(Ptr< ExpressionGraph > graph)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::reuse\+Workspace (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Expression\+Graph} $>$}]{graph}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a9ffa36f849946ba0153bd0e8f18e31f9}{}\label{classmarian_1_1ExpressionGraph_a9ffa36f849946ba0153bd0e8f18e31f9}


Definition at line 86 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
86                                                   \{
87     \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_} = graph->tensors\_;
88   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!save@{save}}
\index{save@{save}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{save(const std\+::string \&name)}{save(const std::string &name)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::save (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a760757f21a572d7e80baf2c1cb0d3521}{}\label{classmarian_1_1ExpressionGraph_a760757f21a572d7e80baf2c1cb0d3521}


Definition at line 454 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
454                                    \{
455     \hyperlink{amun_2common_2logging_8h_a8cad147aca8c526d3c8a03ae14d5c87d}{LOG}(\hyperlink{namespacefix__hard_a31eedbb056537bc1bef47ad5e40eaa68}{info})->info(\textcolor{stringliteral}{"Saving model to \{\}"}, name);
456 
457     std::string mode = \textcolor{stringliteral}{"w"};
458 
459     \hyperlink{classmarian_1_1ExpressionGraph_a0f7e6ae1853ea83f5adc80fe3f5b2cb7}{backend\_}->setDevice(\hyperlink{classmarian_1_1ExpressionGraph_a6de2782630380b0b2d3a1ded6db5324d}{getDevice}());
460     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} p : \hyperlink{classmarian_1_1ExpressionGraph_a01122decdd8ff42c1c4ed519fd0222c9}{params}()->getMap()) \{
461       std::string pName = p.first;
462 
463       \textcolor{keywordflow}{if}(!\hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_}.empty()) \{
464         \textcolor{keywordflow}{if}(pName.substr(0, \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_}.size() + 2) == \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_} + \textcolor{stringliteral}{"::"})
465           pName = pName.substr(\hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_}.size() + 2);
466       \}
467 
468       std::vector<float> v;
469       p.second->val() >> v;
470 
471       \textcolor{keywordtype}{unsigned} \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}[4];
472       \textcolor{keywordtype}{unsigned} dim;
473 
474       \textcolor{keyword}{auto} ps = p.second->shape();
475       \textcolor{keywordflow}{if}(ps[0] == 1 && ps[2] == 1 && ps[3] == 1) \{
476         shape[0] = ps[1];
477         dim = 1;
478         cnpy::npz\_save(name, pName, v.data(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, dim, mode);
479       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ps[2] == 1 && ps[3] == 1) \{
480         shape[0] = ps[0];
481         shape[1] = ps[1];
482         dim = 2;
483         cnpy::npz\_save(name, pName, v.data(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, dim, mode);
484       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ps[3] == 1) \{
485         shape[0] = ps[0];
486         shape[1] = ps[1];
487         shape[2] = ps[2];
488         dim = 3;
489         cnpy::npz\_save(name, pName, v.data(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, dim, mode);
490       \} \textcolor{keywordflow}{else} \{
491         shape[0] = ps[0];
492         shape[1] = ps[1];
493         shape[2] = ps[2];
494         shape[3] = ps[3];
495         dim = 4;
496         cnpy::npz\_save(name, pName, v.data(), \hyperlink{namespacemarian_1_1keywords_a5933d683efd12b59e17a7131fa64cf1c}{shape}, dim, mode);
497       \}
498       mode = \textcolor{stringliteral}{"a"};
499     \}
500   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a760757f21a572d7e80baf2c1cb0d3521_cgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!set\+Device@{set\+Device}}
\index{set\+Device@{set\+Device}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{set\+Device(size\+\_\+t device=0)}{setDevice(size_t device=0)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::set\+Device (
\begin{DoxyParamCaption}
\item[{size\+\_\+t}]{device = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\hypertarget{classmarian_1_1ExpressionGraph_a887b328e3073bbdef1869ae6ff632ca4}{}\label{classmarian_1_1ExpressionGraph_a887b328e3073bbdef1869ae6ff632ca4}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a887b328e3073bbdef1869ae6ff632ca4_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!set\+Reloaded@{set\+Reloaded}}
\index{set\+Reloaded@{set\+Reloaded}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{set\+Reloaded(bool reloaded)}{setReloaded(bool reloaded)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::set\+Reloaded (
\begin{DoxyParamCaption}
\item[{bool}]{reloaded}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_ae3a2ead5df1981b78a78f72c363b5a47}{}\label{classmarian_1_1ExpressionGraph_ae3a2ead5df1981b78a78f72c363b5a47}


Definition at line 421 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
421                                   \{
422     \hyperlink{classmarian_1_1ExpressionGraph_aa10988c85ca38b3a1ffd72fa42278987}{reloaded\_} = reloaded;
423   \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_ae3a2ead5df1981b78a78f72c363b5a47_icgraph}
\end{center}
\end{figure}


\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!switch\+Params@{switch\+Params}}
\index{switch\+Params@{switch\+Params}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{switch\+Params(const std\+::string \&new\+Namespace)}{switchParams(const std::string &newNamespace)}}]{\setlength{\rightskip}{0pt plus 5cm}void marian\+::\+Expression\+Graph\+::switch\+Params (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{new\+Namespace}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_aec6911dc81df2dfbfb2c3ee6cfa6532a}{}\label{classmarian_1_1ExpressionGraph_aec6911dc81df2dfbfb2c3ee6cfa6532a}


Definition at line 70 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
70                                                    \{
71     \hyperlink{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{namespace\_} = newNamespace;
72   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!tensor@{tensor}}
\index{tensor@{tensor}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{tensor(\+Tensor \&t, Args \&\&...\+args)}{tensor(Tensor &t, Args &&...args)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class... Args$>$ void marian\+::\+Expression\+Graph\+::tensor (
\begin{DoxyParamCaption}
\item[{{\bf Tensor} \&}]{t, }
\item[{Args \&\&...}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a7bd933313f66b7a696292fc17b21d78b}{}\label{classmarian_1_1ExpressionGraph_a7bd933313f66b7a696292fc17b21d78b}


Definition at line 399 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
399                                          \{
400     \hyperlink{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{tensors\_}->allocate(t, args...);
401   \}
\end{DoxyCode}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!zeros@{zeros}}
\index{zeros@{zeros}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{zeros(\+Args...\+args)}{zeros(Args...args)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename... Args$>$ {\bf Expr} marian\+::\+Expression\+Graph\+::zeros (
\begin{DoxyParamCaption}
\item[{Args...}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classmarian_1_1ExpressionGraph_a5287d5dbc9db07b0d00e5cbf58d168c3}{}\label{classmarian_1_1ExpressionGraph_a5287d5dbc9db07b0d00e5cbf58d168c3}


Constructs a new node representing a constant (with value 0) in an expression graph. 

This method does not attach the new constant node to any existing expression graph.


\begin{DoxyParams}{Parameters}
{\em args} & X\+XX Marcin, what are args here?\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a newly constructed constant node 
\end{DoxyReturn}


Definition at line 334 of file expression\+\_\+graph.\+h.


\begin{DoxyCode}
334                            \{
335     \textcolor{keywordflow}{return} Expression<ConstantNode>(
336         shared\_from\_this(), \hyperlink{namespacemarian_1_1keywords_afdd3807e3d6fe2bc979d11fa0cf3ee3e}{keywords::init} = \hyperlink{namespacemarian_1_1inits_a1bd34fd256e3df7bb1e27955a7f2b359}{inits::zeros}, args...);
337   \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/db9/classmarian_1_1ExpressionGraph_a5287d5dbc9db07b0d00e5cbf58d168c3_cgraph}
\end{center}
\end{figure}




\subsection{Member Data Documentation}
\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!backend\+\_\+@{backend\+\_\+}}
\index{backend\+\_\+@{backend\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{backend\+\_\+}{backend_}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Backend}$>$ marian\+::\+Expression\+Graph\+::backend\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a0f7e6ae1853ea83f5adc80fe3f5b2cb7}{}\label{classmarian_1_1ExpressionGraph_a0f7e6ae1853ea83f5adc80fe3f5b2cb7}


Definition at line 40 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!count\+\_\+@{count\+\_\+}}
\index{count\+\_\+@{count\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{count\+\_\+}{count_}}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t marian\+::\+Expression\+Graph\+::count\+\_\+ \{0\}\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_af46afb7a2ba6ef751c927ccf98276b57}{}\label{classmarian_1_1ExpressionGraph_af46afb7a2ba6ef751c927ccf98276b57}


Definition at line 30 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!device\+\_\+@{device\+\_\+}}
\index{device\+\_\+@{device\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{device\+\_\+}{device_}}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t marian\+::\+Expression\+Graph\+::device\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a25101cf64e67c3479ff3fff20a84b3a3}{}\label{classmarian_1_1ExpressionGraph_a25101cf64e67c3479ff3fff20a84b3a3}


Definition at line 39 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!hash\+Map\+\_\+@{hash\+Map\+\_\+}}
\index{hash\+Map\+\_\+@{hash\+Map\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{hash\+Map\+\_\+}{hashMap_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::unordered\+\_\+map$<$size\+\_\+t, {\bf W\+Expr}$>$ marian\+::\+Expression\+Graph\+::hash\+Map\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}{}\label{classmarian_1_1ExpressionGraph_aca7c6d3f9253ab38d18d917b8cbd6fd4}


Definition at line 42 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!inference\+Only\+\_\+@{inference\+Only\+\_\+}}
\index{inference\+Only\+\_\+@{inference\+Only\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{inference\+Only\+\_\+}{inferenceOnly_}}]{\setlength{\rightskip}{0pt plus 5cm}bool marian\+::\+Expression\+Graph\+::inference\+Only\+\_\+ \{false\}\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_aa2c948ce5f377474df5f3a30db424541}{}\label{classmarian_1_1ExpressionGraph_aa2c948ce5f377474df5f3a30db424541}


Definition at line 44 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!namespace\+\_\+@{namespace\+\_\+}}
\index{namespace\+\_\+@{namespace\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{namespace\+\_\+}{namespace_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string marian\+::\+Expression\+Graph\+::namespace\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}{}\label{classmarian_1_1ExpressionGraph_a62c31bfad16a2939bced2f37b45dd8d7}


Definition at line 46 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!nodes\+Backward\+\_\+@{nodes\+Backward\+\_\+}}
\index{nodes\+Backward\+\_\+@{nodes\+Backward\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{nodes\+Backward\+\_\+}{nodesBackward_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::list$<${\bf Expr}$>$ marian\+::\+Expression\+Graph\+::nodes\+Backward\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}{}\label{classmarian_1_1ExpressionGraph_a8fa57dfedd51284cf51b1ba25401b646}


Definition at line 33 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!nodes\+Forward\+\_\+@{nodes\+Forward\+\_\+}}
\index{nodes\+Forward\+\_\+@{nodes\+Forward\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{nodes\+Forward\+\_\+}{nodesForward_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::list$<${\bf Expr}$>$ marian\+::\+Expression\+Graph\+::nodes\+Forward\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}{}\label{classmarian_1_1ExpressionGraph_a10819abcacf6b7ea924a895f90059473}


Definition at line 32 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!params\+\_\+@{params\+\_\+}}
\index{params\+\_\+@{params\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{params\+\_\+}{params_}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Parameters}$>$ marian\+::\+Expression\+Graph\+::params\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}{}\label{classmarian_1_1ExpressionGraph_a6abcd5dad584fa5abd9b55b75bb5ef87}


Definition at line 36 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!reloaded\+\_\+@{reloaded\+\_\+}}
\index{reloaded\+\_\+@{reloaded\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{reloaded\+\_\+}{reloaded_}}]{\setlength{\rightskip}{0pt plus 5cm}bool marian\+::\+Expression\+Graph\+::reloaded\+\_\+ \{false\}\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_aa10988c85ca38b3a1ffd72fa42278987}{}\label{classmarian_1_1ExpressionGraph_aa10988c85ca38b3a1ffd72fa42278987}


Definition at line 45 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!tensors\+\_\+@{tensors\+\_\+}}
\index{tensors\+\_\+@{tensors\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{tensors\+\_\+}{tensors_}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Tensor\+Allocator}$>$ marian\+::\+Expression\+Graph\+::tensors\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}{}\label{classmarian_1_1ExpressionGraph_a87f5a687e1d22e0db5e6304540c5e671}


Definition at line 37 of file expression\+\_\+graph.\+h.

\index{marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}!top\+Nodes\+\_\+@{top\+Nodes\+\_\+}}
\index{top\+Nodes\+\_\+@{top\+Nodes\+\_\+}!marian\+::\+Expression\+Graph@{marian\+::\+Expression\+Graph}}
\subsubsection[{\texorpdfstring{top\+Nodes\+\_\+}{topNodes_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::unordered\+\_\+set$<${\bf Expr}$>$ marian\+::\+Expression\+Graph\+::top\+Nodes\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}{}\label{classmarian_1_1ExpressionGraph_a9dc6da42eac5ff91816adf1fa170c6e7}


Definition at line 35 of file expression\+\_\+graph.\+h.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{expression__graph_8h}{expression\+\_\+graph.\+h}\end{DoxyCompactItemize}
